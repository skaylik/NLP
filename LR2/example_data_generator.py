"""
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è NLP Pipeline
"""

import json
from datetime import datetime, timedelta
import random

# –ü—Ä–∏–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
SAMPLE_TEXTS = {
    '–ø–æ–ª–∏—Ç–∏–∫–∞': [
        "–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç –ø—Ä–æ–≤–µ–ª –≤—Å—Ç—Ä–µ—á—É —Å –º–∏–Ω–∏—Å—Ç—Ä–∞–º–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –ø–æ–ª–∏—Ç–∏–∫–∏. –û–±—Å—É–∂–¥–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è —Ä–µ–≥–∏–æ–Ω–æ–≤.",
        "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –¥—É–º–∞ –ø—Ä–∏–Ω—è–ª–∞ –Ω–æ–≤—ã–π –∑–∞–∫–æ–Ω–æ–ø—Ä–æ–µ–∫—Ç –æ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –≤—ã–ø–ª–∞—Ç–∞—Ö. –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ –≤ —Ç—Ä–µ—Ç—å–µ–º —á—Ç–µ–Ω–∏–∏.",
        "–ú–∏–Ω–∏—Å—Ç—Ä –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö –¥–µ–ª –≤—ã—Å—Ç—É–ø–∏–ª —Å –∑–∞—è–≤–ª–µ–Ω–∏–µ–º –æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö –∏ –¥–∏–ø–ª–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–≤—è–∑—è—Ö.",
        "–ü–∞—Ä–ª–∞–º–µ–Ω—Ç—Å–∫–∏–µ –≤—ã–±–æ—Ä—ã —Å–æ—Å—Ç–æ—è—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º –º–µ—Å—è—Ü–µ. –ü–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä—Ç–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ –≤–µ–¥—É—Ç –ø—Ä–µ–¥–≤—ã–±–æ—Ä–Ω—É—é –∫–∞–º–ø–∞–Ω–∏—é."
    ],
    '—ç–∫–æ–Ω–æ–º–∏–∫–∞': [
        "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –±–∞–Ω–∫ –ø—Ä–∏–Ω—è–ª —Ä–µ—à–µ–Ω–∏–µ –æ –ø–æ–≤—ã—à–µ–Ω–∏–∏ –∫–ª—é—á–µ–≤–æ–π —Å—Ç–∞–≤–∫–∏. –ò–Ω—Ñ–ª—è—Ü–∏—è –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ.",
        "–§–æ–Ω–¥–æ–≤—ã–π —Ä—ã–Ω–æ–∫ –ø–æ–∫–∞–∑–∞–ª —Ä–æ—Å—Ç –Ω–∞ —Ñ–æ–Ω–µ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞. –ò–Ω–≤–µ—Å—Ç–æ—Ä—ã –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã.",
        "–ö–æ–º–ø–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–≤–∞—Ä—Ç–∞–ª. –ü—Ä–∏–±—ã–ª—å –ø—Ä–µ–≤—ã—Å–∏–ª–∞ –ø—Ä–æ–≥–Ω–æ–∑—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤.",
        "–ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ —ç–∫–æ–Ω–æ–º–∏–∫–∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª–æ –ø—Ä–æ–≥–Ω–æ–∑ —Ä–æ—Å—Ç–∞ –í–í–ü –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –≥–æ–¥. –û–∂–∏–¥–∞–µ—Ç—Å—è —É–º–µ—Ä–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç —ç–∫–æ–Ω–æ–º–∏–∫–∏."
    ],
    '—Å–ø–æ—Ä—Ç': [
        "–§—É—Ç–±–æ–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –æ–¥–µ—Ä–∂–∞–ª–∞ –ø–æ–±–µ–¥—É –≤ —á–µ–º–ø–∏–æ–Ω–∞—Ç–µ. –ú–∞—Ç—á –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å–æ —Å—á–µ—Ç–æ–º —Ç—Ä–∏ –∫ –æ–¥–Ω–æ–º—É.",
        "–û–ª–∏–º–ø–∏–π—Å–∫–∏–µ –∏–≥—Ä—ã —Å—Ç–∞—Ä—Ç—É—é—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º –º–µ—Å—è—Ü–µ. –°–ø–æ—Ä—Ç—Å–º–µ–Ω—ã –≥–æ—Ç–æ–≤—è—Ç—Å—è –∫ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è–º.",
        "–¢–µ–Ω–Ω–∏—Å–∏—Å—Ç –≤—ã—à–µ–ª –≤ —Ñ–∏–Ω–∞–ª —Ç—É—Ä–Ω–∏—Ä–∞ –±–æ–ª—å—à–æ–≥–æ —à–ª–µ–º–∞. –ú–∞—Ç—á –±—ã–ª –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω—ã–º –∏ –¥–ª–∏–ª—Å—è —á–µ—Ç—ã—Ä–µ —á–∞—Å–∞.",
        "–•–æ–∫–∫–µ–π–Ω–∞—è —Å–±–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–æ–¥–∏—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π —Å–±–æ—Ä –ø–µ—Ä–µ–¥ —á–µ–º–ø–∏–æ–Ω–∞—Ç–æ–º –º–∏—Ä–∞. –¢—Ä–µ–Ω–µ—Ä –æ–±—ä—è–≤–∏–ª —Å–æ—Å—Ç–∞–≤ –∫–æ–º–∞–Ω–¥—ã."
    ],
    '–∫—É–ª—å—Ç—É—Ä–∞': [
        "–í —Ç–µ–∞—Ç—Ä–µ —Å–æ—Å—Ç–æ—è–ª–∞—Å—å –ø—Ä–µ–º—å–µ—Ä–∞ –Ω–æ–≤–æ–π –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –ø—å–µ—Å—ã. –ó—Ä–∏—Ç–µ–ª–∏ –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ —Å–ø–µ–∫—Ç–∞–∫–ª—å –æ–≤–∞—Ü–∏—è–º–∏.",
        "–ò–∑–≤–µ—Å—Ç–Ω—ã–π —Ö—É–¥–æ–∂–Ω–∏–∫ –æ—Ç–∫—Ä—ã–ª –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –≤—ã—Å—Ç–∞–≤–∫—É –≤ –º—É–∑–µ–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–µ—Ç.",
        "–ö–∏–Ω–æ—Ñ–µ—Å—Ç–∏–≤–∞–ª—å –æ–±—ä—è–≤–∏–ª –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π –≤ –Ω–æ–º–∏–Ω–∞—Ü–∏—è—Ö. –ì–ª–∞–≤–Ω—ã–π –ø—Ä–∏–∑ –ø–æ–ª—É—á–∏–ª —Ñ–∏–ª—å–º –º–æ–ª–æ–¥–æ–≥–æ —Ä–µ–∂–∏—Å—Å–µ—Ä–∞.",
        "–§–∏–ª–∞—Ä–º–æ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∞ –ø—Ä–æ–≥—Ä–∞–º–º—É –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤ –Ω–∞ –Ω–æ–≤—ã–π —Å–µ–∑–æ–Ω. –í—ã—Å—Ç—É–ø—è—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –º—É–∑—ã–∫–∞–Ω—Ç—ã –∏ –æ—Ä–∫–µ—Å—Ç—Ä—ã."
    ]
}

TITLES = {
    '–ø–æ–ª–∏—Ç–∏–∫–∞': [
        "–í—Å—Ç—Ä–µ—á–∞ –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ —Å –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ–º",
        "–î—É–º–∞ –ø—Ä–∏–Ω—è–ª–∞ –Ω–æ–≤—ã–π –∑–∞–∫–æ–Ω",
        "–ó–∞—è–≤–ª–µ–Ω–∏–µ –ú–ò–î –æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö",
        "–ü–∞—Ä–ª–∞–º–µ–Ω—Ç—Å–∫–∏–µ –≤—ã–±–æ—Ä—ã: –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞"
    ],
    '—ç–∫–æ–Ω–æ–º–∏–∫–∞': [
        "–¶–ë –ø–æ–≤—ã—Å–∏–ª –∫–ª—é—á–µ–≤—É—é —Å—Ç–∞–≤–∫—É",
        "–†–æ—Å—Ç –Ω–∞ —Ñ–æ–Ω–¥–æ–≤–æ–º —Ä—ã–Ω–∫–µ",
        "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç –∫–æ–º–ø–∞–Ω–∏–∏",
        "–ü—Ä–æ–≥–Ω–æ–∑ —Ä–æ—Å—Ç–∞ –í–í–ü"
    ],
    '—Å–ø–æ—Ä—Ç': [
        "–ü–æ–±–µ–¥–∞ –≤ —á–µ–º–ø–∏–æ–Ω–∞—Ç–µ –ø–æ —Ñ—É—Ç–±–æ–ª—É",
        "–°—Ç–∞—Ä—Ç –û–ª–∏–º–ø–∏–π—Å–∫–∏—Ö –∏–≥—Ä",
        "–§–∏–Ω–∞–ª —Ç—É—Ä–Ω–∏—Ä–∞ –±–æ–ª—å—à–æ–≥–æ —à–ª–µ–º–∞",
        "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —á–µ–º–ø–∏–æ–Ω–∞—Ç—É –º–∏—Ä–∞"
    ],
    '–∫—É–ª—å—Ç—É—Ä–∞': [
        "–ü—Ä–µ–º—å–µ—Ä–∞ –≤ —Ç–µ–∞—Ç—Ä–µ",
        "–í—ã—Å—Ç–∞–≤–∫–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞",
        "–ò—Ç–æ–≥–∏ –∫–∏–Ω–æ—Ñ–µ—Å—Ç–∏–≤–∞–ª—è",
        "–ù–æ–≤—ã–π —Å–µ–∑–æ–Ω —Ñ–∏–ª–∞—Ä–º–æ–Ω–∏–∏"
    ]
}

def generate_sample_jsonl(output_file='sample_corpus.jsonl', num_records=100):
    """
    –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç JSONL —Ñ–∞–π–ª —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
    
    Args:
        output_file: –ø—É—Ç—å –∫ –≤—ã—Ö–æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—É
        num_records: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
    """
    
    categories = list(SAMPLE_TEXTS.keys())
    base_date = datetime.now() - timedelta(days=365)
    
    with open(output_file, 'w', encoding='utf-8') as f:
        for i in range(num_records):
            # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
            category = random.choice(categories)
            
            # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —Ç–µ–∫—Å—Ç –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
            text_idx = random.randint(0, len(SAMPLE_TEXTS[category]) - 1)
            text = SAMPLE_TEXTS[category][text_idx]
            title = TITLES[category][text_idx]
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞—Ç—É
            days_offset = random.randint(0, 365)
            date = (base_date + timedelta(days=days_offset)).strftime('%Y-%m-%d')
            
            # –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å
            record = {
                'title': f"{title} - {i+1}",
                'text': text,
                'date': date,
                'url': f'https://example.com/news/{category}/{i+1}',
                'category': category
            }
            
            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ —Ñ–∞–π–ª
            f.write(json.dumps(record, ensure_ascii=False) + '\n')
    
    print(f"‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª {output_file} —Å {num_records} –∑–∞–ø–∏—Å—è–º–∏")
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    category_counts = {cat: 0 for cat in categories}
    
    with open(output_file, 'r', encoding='utf-8') as f:
        for line in f:
            data = json.loads(line.strip())
            category_counts[data['category']] += 1
    
    print("\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:")
    for cat, count in category_counts.items():
        print(f"  {cat}: {count} –∑–∞–ø–∏—Å–µ–π")

if __name__ == "__main__":
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 3 —Ñ–∞–π–ª–∞ —Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
    
    print("–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
    print("=" * 50)
    
    # –ú–∞–ª–µ–Ω—å–∫–∏–π –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    print("\n1. –ú–∞–ª–µ–Ω—å–∫–∏–π —Ñ–∞–π–ª (100 –∑–∞–ø–∏—Å–µ–π)")
    generate_sample_jsonl('sample_small.jsonl', 100)
    
    # –°—Ä–µ–¥–Ω–∏–π –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    print("\n2. –°—Ä–µ–¥–Ω–∏–π —Ñ–∞–π–ª (500 –∑–∞–ø–∏—Å–µ–π)")
    generate_sample_jsonl('sample_medium.jsonl', 500)
    
    # –ë–æ–ª—å—à–æ–π –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    print("\n3. –ë–æ–ª—å—à–æ–π —Ñ–∞–π–ª (2000 –∑–∞–ø–∏—Å–µ–π)")
    generate_sample_jsonl('sample_large.jsonl', 2000)
    
    print("\n" + "=" * 50)
    print("‚úÖ –í—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã!")
    print("\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ —Ñ–∞–π–ª—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:")
    print("  - sample_small.jsonl  - –±—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ")
    print("  - sample_medium.jsonl - –æ–±—ã—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ")
    print("  - sample_large.jsonl  - –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ")






